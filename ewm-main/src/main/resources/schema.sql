--таблица для запуска приложения, с пустым файлом не запускается
CREATE TABLE IF NOT EXISTS users (
    id BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    email VARCHAR(255) NOT NULL UNIQUE
);

-- таблица для определения локации
CREATE TABLE IF NOT EXISTS LOCATIONS
(
    ID  BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    LAT FLOAT                                   NOT NULL,
    LON FLOAT                                   NOT NULL,
    CONSTRAINT PK_LOCATION
        PRIMARY KEY (ID)
);

-- таблица событий
CREATE TABLE IF NOT EXISTS EVENTS
(
    ID                 BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    ANNOTATION         VARCHAR(500),
    CATEGORY_ID        BIGINT,
    CONFIRMED_REQUESTS BIGINT,
    DESCRIPTION        TEXT,
    EVENT_DATE         TIMESTAMP WITHOUT TIME ZONE,
    CREATED_ON         TIMESTAMP WITHOUT TIME ZONE,
    INITIATOR_ID       BIGINT,
    LOCATION_ID        BIGINT,
    PAID               BOOLEAN,
    PARTICIPANT_LIMIT  INTEGER,
    PUBLISHED_ON       TIMESTAMP WITHOUT TIME ZONE,
    REQUEST_MODERATION BOOLEAN,
    STATE              VARCHAR(120),
    TITLE              VARCHAR(120),
    VIEWS              BIGINT,
    CONSTRAINT PK_EVENT
        PRIMARY KEY (ID),
    CONSTRAINT EVENTS_CATEGORIES_ID_FK
        FOREIGN KEY (CATEGORY_ID)
            REFERENCES CATEGORIES (ID) ON DELETE CASCADE,
    CONSTRAINT EVENTS_LOCATIONS_ID_FK
        FOREIGN KEY (LOCATION_ID)
            REFERENCES LOCATIONS (ID) ON DELETE CASCADE,
    CONSTRAINT EVENTS_USERS_ID_FK
        FOREIGN KEY (INITIATOR_ID)
            REFERENCES USERS (ID) ON DELETE CASCADE
);

CREATE TABLE participation_requests (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    requester_id BIGINT NOT NULL,
    event_id BIGINT NOT NULL,
    status VARCHAR(20) NOT NULL,
    created TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);