# ExploreWithMe

**ExploreWithMe** (с англ. — «исследуй со мной») — это афишное приложение, которое позволяет пользователям делиться информацией об интересных событиях (от выставок до походов в кино) и находить компанию для участия в них.

## Стек технологий

*   **Backend:** Java, Spring Boot, Spring Data JPA
*   **База данных:** PostgreSQL
*   **Сборка:** Maven
*   **Документация API:** Swagger/OpenAPI

## Архитектура

Проект состоит из двух независимых микросервисов:

1.  **Основной сервис (ewm-main):** Содержит всю бизнес-логику для работы с событиями, пользователями, категориями и заявками.
2.  **Сервис статистики (ewm-stats):** Собирает и предоставляет данные о количестве просмотров событий.

## Функциональность

### Основной сервис

API основного сервиса разделен на три части:

#### Публичное API

*   **Поиск и фильтрация событий:** Получение списка событий с возможностью фильтрации по различным параметрам.
*   **Сортировка:** Сортировка событий по дате или по количеству просмотров.
*   **Просмотр событий:** Получение краткой и подробной информации о конкретном событии.
*   **Работа с категориями и подборками:** Получение списка категорий и тематических подборок событий, составленных администраторами.
*   **Сбор статистики:** Все публичные запросы фиксируются для сбора статистики просмотров.

#### Закрытое API (для авторизованных пользователей)

*   **Управление событиями:** Пользователи могут создавать, редактировать и просматривать свои события.
*   **Участие в событиях:** Подача заявок на участие в мероприятиях других пользователей.
*   **Модерация заявок:** Создатели событий могут подтверждать или отклонять заявки на участие.

#### Административное API

*   **Управление категориями:** Добавление, изменение и удаление категорий событий.
*   **Управление подборками:** Создание, удаление и закрепление подборок событий на главной странице.
*   **Модерация событий:** Публикация или отклонение событий, созданных пользователями.
*   **Управление пользователями:** Добавление, активация, просмотр и удаление пользователей.

### Сервис статистики

*   **Сбор данных:** Запись информации о каждом обращении к публичным эндпоинтам (`GET /events` и `GET /events/{id}`).
*   **Предоставление статистики:** Формирование выборок и статистики за выбранные даты по конкретным эндпоинтам.

## Модель данных и жизненный цикл события

Событие проходит несколько стадий:

1.  **Создание** -> `PENDING` (Ожидание публикации)
2.  **Публикация администратором** -> `PUBLISHED`
3.  **Отмена публикации:**
    *   Администратором -> `CANCELED`
    *   Инициатором события (на этапе `PENDING`) -> `CANCELED`

## Аутентификация и авторизация

Сервисы работают внутри защищенной сети (VPN). Аутентификация и авторизация запросов к закрытой и административной частям API осуществляется на уровне сетевого шлюза (не входит в состав данного проекта). Если запрос дошел до сервиса, он считается авторизованным.

## Запуск проекта

1.  **Клонируйте репозиторий:**
    ```bash
    git clone <URL-репозитория>
    cd explore-with-me
    ```

2.  **Настройте базы данных:** Убедитесь, что запущены и настроены два экземпляра PostgreSQL для `ewm-main` и `ewm-stats`.

3.  **Настройте приложения:** В файлах `application.properties` (или `application.yml`) для каждого сервиса укажите корректные URL для подключения к БД и другие параметры.

4.  **Запустите сервисы:**
    *   Можно запускать каждый сервис отдельно из IDE.
    *   Или собрать и запустить с помощью Maven:
    ```bash
    mvn clean package
    java -jar ewm-stats-service/target/ewm-stats-service.jar
    java -jar ewm-main-service/target/ewm-main-service.jar
    ```

## Документация API

Спецификации API подготовлены в формате OpenAPI 3.0:

*   **Спецификация основного сервиса:** [ewm-main-service-spec.json](ewm-main-service-spec.json)
*   **Спецификация сервиса статистики:** [ewm-stats-service.json](ewm-stats-service.json)

Для просмотра и взаимодействия с API:
1.  Скопируйте путь к файлу спецификации.
2.  Откройте [онлайн-редактор Swagger](https://editor.swagger.io/).
3.  Выберите `File -> Import URL` и вставьте ссылку на файл спецификации.

## Дополнительная функциональность (Feature)

В проекте реализована дополнительная функциональность, расположенная в отдельной ветке `feature`.

**Реализованная фича: Комментарии**

*   **Описание:** Возможность для авторизованных пользователей оставлять комментарии к опубликованным событиям.
*   **Функциональность:**
    *   Добавление комментария.
    *   Редактирование и удаление собственного комментария.
    *   Просмотр всех комментариев к событию (публичный эндпоинт).
    *   Модерация комментариев администратором: удаление комментариев, нарушающих правила сервиса.
*   **Модель данных:** Комментарии имеют статусы (например, `PUBLISHED`, `PENDING`, `REJECTED`), что позволяет гибко управлять контентом.

---

**У вас точно всё получится! Вы уже молодец! Вы много знаете и умеете! Да пребудет с вами сила!**